"use strict";(globalThis.webpackChunktechnical_notes_for_microsoft_workloads_on_aws=globalThis.webpackChunktechnical_notes_for_microsoft_workloads_on_aws||[]).push([[2109],{1007(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"Licensing/Guides/Convert_Office_to_32-bit/index","title":"Convert Office LTSC 64-bit to 32-bit on EC2 Windows","description":"by Ali Alzand","source":"@site/docs/Licensing/Guides/Convert_Office_to_32-bit/index.md","sourceDirName":"Licensing/Guides/Convert_Office_to_32-bit","slug":"/Licensing/Guides/Convert_Office_to_32-bit/","permalink":"/technical-notes-for-microsoft-workloads-on-aws/Licensing/Guides/Convert_Office_to_32-bit/","draft":false,"unlisted":false,"editUrl":"https://github.com/aws-samples/technical-notes-for-microsoft-workloads-on-aws/blob/main/docusaurus/docs/Licensing/Guides/Convert_Office_to_32-bit/index.md","tags":[],"version":"current","sidebarPosition":40,"frontMatter":{"sidebar_position":40},"sidebar":"tutorialSidebar","previous":{"title":"Migrate from BYOL with Dedicated Hosts to Shared Tenancy","permalink":"/technical-notes-for-microsoft-workloads-on-aws/Licensing/Guides/Migrate_from_BYOL_with_Dedicated_Hosts_to_Shared_Tenancy/"},"next":{"title":"Licensing FAQs","permalink":"/technical-notes-for-microsoft-workloads-on-aws/Licensing/FAQs/"}}');var s=i(4848),o=i(8453);const r={sidebar_position:40},c="Convert Office LTSC 64-bit to 32-bit on EC2 Windows",l={},a=[{value:"Why 32-bit Office?",id:"why-32-bit-office",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Workflow",id:"workflow",level:2},{value:"Step 1: Uninstall 64-bit Office",id:"step-1-uninstall-64-bit-office",level:3},{value:"Step 2: Prepare Office Deployment Tool",id:"step-2-prepare-office-deployment-tool",level:3},{value:"Step 3: Download and Install 32-bit Office",id:"step-3-download-and-install-32-bit-office",level:3},{value:"Step 4: Activate Office with AWS License Manager",id:"step-4-activate-office-with-aws-license-manager",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"convert-office-ltsc-64-bit-to-32-bit-on-ec2-windows",children:"Convert Office LTSC 64-bit to 32-bit on EC2 Windows"})}),"\n",(0,s.jsx)(n.p,{children:"by Ali Alzand"}),"\n",(0,s.jsx)(n.p,{children:"This guide walks you through converting a 64-bit Office installation to 32-bit Office LTSC Professional Plus 2021 on an EC2 Windows instance and activating it using AWS License Manager."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," This guide is specifically for instances launched from the ",(0,s.jsx)(n.a,{href:"https://aws.amazon.com/marketplace/pp/prodview-bh46d5p2hapns",children:"Office LTSC Professional Plus 2021 AWS Marketplace offering"}),". It uses AWS License Manager for activation and requires the appropriate VPC endpoint configuration."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"why-32-bit-office",children:"Why 32-bit Office?"}),"\n",(0,s.jsx)(n.p,{children:"While 64-bit Office is recommended for most scenarios, you may need 32-bit Office for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Compatibility with legacy 32-bit add-ins or ActiveX controls"}),"\n",(0,s.jsx)(n.li,{children:"Integration with older 32-bit applications"}),"\n",(0,s.jsx)(n.li,{children:"Specific business requirements that depend on 32-bit COM objects"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/license-manager/latest/userguide/user-based-subscriptions.html#user-subs-ms-office",children:"License Manager user-based subscriptions"})," configured for Microsoft Office. See this ",(0,s.jsx)(n.a,{href:"https://aws.amazon.com/blogs/modernizing-with-aws/how-to-set-up-microsoft-office-on-amazon-ec2/",children:"blog post"})," for detailed setup instructions."]}),"\n",(0,s.jsxs)(n.li,{children:["EC2 Windows instance launched from the ",(0,s.jsx)(n.a,{href:"https://aws.amazon.com/marketplace/pp/prodview-bh46d5p2hapns",children:"Office LTSC Professional Plus 2021 AWS Marketplace AMI"})," with 64-bit Office installed"]}),"\n",(0,s.jsx)(n.li,{children:"Instance deployed in a subnet with internet connectivity (required for downloading Office installation files)"}),"\n",(0,s.jsx)(n.li,{children:"RDP access to the instance configured and tested"}),"\n",(0,s.jsx)(n.li,{children:"User associated with administrative privileges on the instance"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"workflow",children:"Workflow"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-uninstall-64-bit-office",children:"Step 1: Uninstall 64-bit Office"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"RDP to the instance"}),"\n",(0,s.jsxs)(n.li,{children:["Open ",(0,s.jsx)(n.strong,{children:"Programs and Features"})," (Control Panel)"]}),"\n",(0,s.jsx)(n.li,{children:"Uninstall the current Office installation (64-bit version)"}),"\n",(0,s.jsx)(n.li,{children:"Reboot the instance"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-2-prepare-office-deployment-tool",children:"Step 2: Prepare Office Deployment Tool"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Download the ",(0,s.jsx)(n.a,{href:"https://www.microsoft.com/en-us/download/details.aspx?id=49117",children:"Office Deployment Tool"})]}),"\n",(0,s.jsx)(n.li,{children:"Run the executable and accept the license agreement"}),"\n",(0,s.jsxs)(n.li,{children:["Select a folder to extract the tool (e.g., ",(0,s.jsx)(n.code,{children:"C:\\ODT"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Download the ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(1250).A+"",children:"configuration.xml"})]}),"\n",(0,s.jsx)(n.li,{children:"Place the configuration.xml file in the ODT folder from step 3 above"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-3-download-and-install-32-bit-office",children:"Step 3: Download and Install 32-bit Office"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Open Command Prompt as administrator"}),"\n",(0,s.jsxs)(n.li,{children:["Navigate to your ODT folder: ",(0,s.jsx)(n.code,{children:"cd C:\\ODT"})]}),"\n",(0,s.jsxs)(n.li,{children:["Download Office files: ",(0,s.jsx)(n.code,{children:"setup.exe /download configuration.xml"})]}),"\n",(0,s.jsxs)(n.li,{children:["Install Office: ",(0,s.jsx)(n.code,{children:"setup.exe /configure configuration.xml"})]}),"\n",(0,s.jsx)(n.li,{children:"Open any Office application (e.g., Word) and accept the license agreement"}),"\n",(0,s.jsxs)(n.li,{children:["Verify 32-bit installation by opening Word \u2192 ",(0,s.jsx)(n.strong,{children:"File"})," \u2192 ",(0,s.jsx)(n.strong,{children:"Account"})," \u2192 ",(0,s.jsx)(n.strong,{children:"About Word"}),' (should show "32-bit")']}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-4-activate-office-with-aws-license-manager",children:"Step 4: Activate Office with AWS License Manager"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the AWS Console, go to ",(0,s.jsx)(n.strong,{children:"VPC"})," \u2192 ",(0,s.jsx)(n.strong,{children:"Endpoints"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Locate the endpoint: ",(0,s.jsx)(n.code,{children:"com.amazonaws.<region>.activation-license-manager"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Copy the first DNS name (e.g., ",(0,s.jsx)(n.code,{children:"vpce-xxxxx.activation-license-manager.us-east-1.vpce.amazonaws.com"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Open PowerShell as administrator and run the following script (replace ",(0,s.jsx)(n.code,{children:"UpdateMe"})," with your DNS name):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:'$Endpoint="UpdateMe"\n$dnsResult = Resolve-DnsName "$Endpoint" -Server "169.254.169.253" -ErrorAction Stop\n$ipv4Address = $dnsResult | Where-Object { $_.Type -eq "A" } | Select-Object -First 1\n$ServerIPAddress = $ipv4Address.IPAddress\n\n$Path = \'C:\\Program Files (x86)\\Microsoft Office\\Office16\'\nSet-Location -Path $Path\nWrite-Output "Running the activation script with the license manager: $ServerIPAddress"\ncscript ospp.vbs /sethst:$ServerIPAddress\ncscript ospp.vbs /act\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"You should see output similar to:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"---Processing--------------------------\n---------------------------------------\nInstalled product key detected - attempting to activate the following product:\nSKU ID: fbdb3e18-a8ef-4fb3-9183-dffd60bd0984\nLICENSE NAME: Office 21, Office21ProPlus2021VL_KMS_Client_AE edition\nLICENSE DESCRIPTION: Office 21, VOLUME_KMSCLIENT channel\nLast 5 characters of installed product key: 6F7TH\n<Product activation successful>\n---------------------------------------\n---------------------------------------\n---Exiting-----------------------------\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Verify activation status:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"cscript ospp.vbs /dstatus\n"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1250(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/files/configuration-276aaa6dbdf9996fe1fa985e23725c96.xml"},8453(e,n,i){i.d(n,{R:()=>r,x:()=>c});var t=i(6540);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);