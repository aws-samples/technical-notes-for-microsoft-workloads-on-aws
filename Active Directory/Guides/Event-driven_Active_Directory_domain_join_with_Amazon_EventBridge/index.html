<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Active Directory/Guides/Event-driven_Active_Directory_domain_join_with_Amazon_EventBridge/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Event-driven Active Directory domain join with Amazon EventBridge | Technical Notes for Microsoft Workloads on AWS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://aws-samples.github.io/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Event-driven_Active_Directory_domain_join_with_Amazon_EventBridge/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Event-driven Active Directory domain join with Amazon EventBridge | Technical Notes for Microsoft Workloads on AWS"><meta data-rh="true" name="description" content="by Syed Ahmad"><meta data-rh="true" property="og:description" content="by Syed Ahmad"><link data-rh="true" rel="icon" href="/technical-notes-for-microsoft-workloads-on-aws/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aws-samples.github.io/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Event-driven_Active_Directory_domain_join_with_Amazon_EventBridge/"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Event-driven_Active_Directory_domain_join_with_Amazon_EventBridge/" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Event-driven_Active_Directory_domain_join_with_Amazon_EventBridge/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Active Directory","item":"https://aws-samples.github.io/technical-notes-for-microsoft-workloads-on-aws/Active Directory/"},{"@type":"ListItem","position":2,"name":"Guides","item":"https://aws-samples.github.io/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/"},{"@type":"ListItem","position":3,"name":"Event-driven Active Directory domain join with Amazon EventBridge","item":"https://aws-samples.github.io/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Event-driven_Active_Directory_domain_join_with_Amazon_EventBridge/"}]}</script><link rel="alternate" type="application/rss+xml" href="/technical-notes-for-microsoft-workloads-on-aws/blog/rss.xml" title="Technical Notes for Microsoft Workloads on AWS RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/technical-notes-for-microsoft-workloads-on-aws/blog/atom.xml" title="Technical Notes for Microsoft Workloads on AWS Atom Feed"><link rel="stylesheet" href="/technical-notes-for-microsoft-workloads-on-aws/assets/css/styles.7d891adc.css">
<script src="/technical-notes-for-microsoft-workloads-on-aws/assets/js/runtime~main.dc128bd5.js" defer="defer"></script>
<script src="/technical-notes-for-microsoft-workloads-on-aws/assets/js/main.2bc42100.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/technical-notes-for-microsoft-workloads-on-aws/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/technical-notes-for-microsoft-workloads-on-aws/"><div class="navbar__logo"><img src="/technical-notes-for-microsoft-workloads-on-aws/img/logo.svg" alt="AWS Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/technical-notes-for-microsoft-workloads-on-aws/img/logo.svg" alt="AWS Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Technical Notes for Microsoft Workloads on AWS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/home">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/DotNET/Guides/">.NET</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/">Active Directory</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/Windows Containers/Guides/">Windows Containers</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/SQL Server/Guides/">SQL Server</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/EC2 Windows/Guides/">EC2 Windows</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/Licensing/Guides/">Licensing</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/Desktop Engineering/Guides/">Desktop Engineering</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/aws-samples/technical-notes-for-microsoft-workloads-on-aws" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/technical-notes-for-microsoft-workloads-on-aws/home"><span title="About Technical Notes for Microsoft Workloads on AWS" class="linkLabel_WmDU">About Technical Notes for Microsoft Workloads on AWS</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/technical-notes-for-microsoft-workloads-on-aws/Desktop Engineering/"><span title="Desktop Engineering" class="categoryLinkLabel_W154">Desktop Engineering</span></a><button aria-label="Expand sidebar category &#x27;Desktop Engineering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/technical-notes-for-microsoft-workloads-on-aws/DotNET/"><span title=".NET" class="categoryLinkLabel_W154">.NET</span></a><button aria-label="Expand sidebar category &#x27;.NET&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/"><span title="Active Directory" class="categoryLinkLabel_W154">Active Directory</span></a><button aria-label="Collapse sidebar category &#x27;Active Directory&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/"><span title="Guides" class="categoryLinkLabel_W154">Guides</span></a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Windows_LAPS_&amp;_AWS_Microsoft_Managed_Active_Directory/"><span title="Quickly deploy a self-managed AD Forest on Amazon EC2" class="linkLabel_WmDU">Quickly deploy a self-managed AD Forest on Amazon EC2</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Optimizing_Directory_Sharing_in_AWS_Managed_Microsoft_AD/"><span title="Optimizing Directory Sharing in AWS Managed Microsoft AD" class="linkLabel_WmDU">Optimizing Directory Sharing in AWS Managed Microsoft AD</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Active_Directory_domain_join_with_AWS_Systems_Manager_and_AWS_Secrets_Manager/"><span title="Active Directory domain join with AWS Systems Manager and AWS Secrets Manager" class="linkLabel_WmDU">Active Directory domain join with AWS Systems Manager and AWS Secrets Manager</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Event-driven_Active_Directory_domain_join_with_Amazon_EventBridge/"><span title="Event-driven Active Directory domain join with Amazon EventBridge" class="linkLabel_WmDU">Event-driven Active Directory domain join with Amazon EventBridge</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/technical-notes-for-microsoft-workloads-on-aws/Windows Containers/"><span title="Windows Containers" class="categoryLinkLabel_W154">Windows Containers</span></a><button aria-label="Expand sidebar category &#x27;Windows Containers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/technical-notes-for-microsoft-workloads-on-aws/SQL Server/"><span title="SQL Server" class="categoryLinkLabel_W154">SQL Server</span></a><button aria-label="Expand sidebar category &#x27;SQL Server&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/technical-notes-for-microsoft-workloads-on-aws/EC2 Windows/"><span title="EC2 Windows" class="categoryLinkLabel_W154">EC2 Windows</span></a><button aria-label="Expand sidebar category &#x27;EC2 Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/technical-notes-for-microsoft-workloads-on-aws/Licensing/"><span title="Licensing" class="categoryLinkLabel_W154">Licensing</span></a><button aria-label="Expand sidebar category &#x27;Licensing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/technical-notes-for-microsoft-workloads-on-aws/AWS re:Invent/"><span title="AWS re:Invent" class="categoryLinkLabel_W154">AWS re:Invent</span></a><button aria-label="Expand sidebar category &#x27;AWS re:Invent&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/technical-notes-for-microsoft-workloads-on-aws/Code Repo/"><span title="Code Repo" class="categoryLinkLabel_W154">Code Repo</span></a><button aria-label="Expand sidebar category &#x27;Code Repo&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/technical-notes-for-microsoft-workloads-on-aws/Workshops"><span title="Workshops" class="linkLabel_WmDU">Workshops</span></a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/technical-notes-for-microsoft-workloads-on-aws/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/"><span>Active Directory</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/"><span>Guides</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Event-driven Active Directory domain join with Amazon EventBridge</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Event-driven Active Directory domain join with Amazon EventBridge</h1></header>
<p>by Syed Ahmad</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction" translate="no">​</a></h2>
<p>In this post, I will show you how <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html" target="_blank" rel="noopener noreferrer" class="">Amazon EventBridge</a> can automate Microsoft Active Directory (AD) domain join and unjoin for your <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html" target="_blank" rel="noopener noreferrer" class="">Amazon Elastic Compute Cloud (Amazon EC2)</a> instances. In a previous <a href="https://aws-samples.github.io/technical-notes-for-microsoft-workloads-on-aws/Active%20Directory/Guides/Active_Directory_domain_join_with_AWS_Systems_Manager_and_AWS_Secrets_Manager/" target="_blank" rel="noopener noreferrer" class="">post</a>, I showed you how <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-automation.html" target="_blank" rel="noopener noreferrer" class="">AWS Systems Manager Automation</a> can dynamically domain join and unjoin EC2 instances manually. I will show you two examples of AD domain join and unjoin automation that are event driven, Amazon EC2 tag triggering <a href="https://docs.aws.amazon.com/lambda/latest/dg/welcome.html" target="_blank" rel="noopener noreferrer" class="">AWS Lambda</a> and <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/what-is-amazon-ec2-auto-scaling.html" target="_blank" rel="noopener noreferrer" class="">Amazon EC2 Auto Scaling</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="solution-overview">Solution Overview<a href="#solution-overview" class="hash-link" aria-label="Direct link to Solution Overview" title="Direct link to Solution Overview" translate="no">​</a></h2>
<p>EventBridge is a serverless service that lets you connect applications using events. It listens for specific events in your AWS environment based on rules and subsequently triggers actions in response (Figure 1). This post presents two solutions for domain join and unjoin using EventBridge. The first solution allows you to domain join or unjoin with Amazon EC2 tags. The second solution allows you to domain join or unjoin with Amazon EC2 Auto Scaling.</p>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image1-8300291c19b6dfa97955a5b1d21e664e.png" width="827" height="439" class="img_ev3q"></p>
<p>Figure 1 - Example Amazon EventBridge workflow which routes events to an AWS Lambda function and then AWS Systems Manager Automation.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<p>Both solutions are available as <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html" target="_blank" rel="noopener noreferrer" class="">AWS CloudFormation</a> templates. To start, deploy the <a href="https://github.com/aws-samples/ssm-automation-custom-ad-domain-join-unjoin/blob/main/templates/cloudformation/cfn-create-ssm-automation-secretmanager-adjoin.yml" target="_blank" rel="noopener noreferrer" class="">Automation runbook</a> from the previous post.</p>
<p><strong>Note:</strong> This guide assumes DNS has been configured already for your AD environment running in AWS. Configuring DNS at scale is beyond the scope of this blog. You can review existing guides to configure such an environment with either <a href="https://d1.awsstatic.com/whitepapers/aws-hybrid-dns-with-active-directory.pdf" target="_blank" rel="noopener noreferrer" class="">Amazon Route 53 Resolver endpoints</a> or <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_DHCP_Options.html" target="_blank" rel="noopener noreferrer" class="">DHCP option sets in Amazon
VPC</a>.</p>
<p>The components of the <a href="https://github.com/aws-samples/ssm-automation-custom-ad-domain-join-unjoin/blob/main/templates/cloudformation/cfn-evb-lambda-tags-adjoinunjoin.yaml" target="_blank" rel="noopener noreferrer" class="">EC2 tag solution</a> include:</p>
<ul>
<li class="">A Python-based <a href="https://github.com/aws-samples/ssm-automation-custom-ad-domain-join-unjoin/blob/main/templates/lambda/ec2-tags-domainjoinunjoin.py" target="_blank" rel="noopener noreferrer" class="">Lambda function</a>.</li>
<li class="">An EventBridge rule that triggers the Lambda function.</li>
<li class=""><a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/setup-instance-profile.html" target="_blank" rel="noopener noreferrer" class="">Identity and Access Management (IAM) roles</a> to provide permissions to the Lambda function.</li>
<li class=""><a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html" target="_blank" rel="noopener noreferrer" class="">Amazon CloudWatch Logs</a> that logs Lambda function output.</li>
<li class="">To create the Lambda function manually, [download] the <a href="https://github.com/aws-samples/ssm-automation-custom-ad-domain-join-unjoin/blob/main/templates/lambda/ec2-tags-domainjoinunjoin.py" target="_blank" rel="noopener noreferrer" class="">Python function from GitHub</a>.</li>
</ul>
<p>The components of the <a href="https://github.com/aws-samples/ssm-automation-custom-ad-domain-join-unjoin/blob/main/templates/cloudformation/cfn-evb-ssm-automation-adjoinunjoin.yaml" target="_blank" rel="noopener noreferrer" class="">Amazon EC2 Auto Scaling solution</a> include:</p>
<ul>
<li class="">An Auto Scaling group.</li>
<li class="">Two lifecycle hooks.<!-- -->
<ul>
<li class="">One lifecycle hook for instance launching.</li>
<li class="">One lifecycle hook for instance termination.</li>
</ul>
</li>
<li class="">An <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/launch-templates.html" target="_blank" rel="noopener noreferrer" class="">Amazon EC2 launch template</a> associated with the Auto Scaling group.</li>
<li class=""><a href="https://docs.aws.amazon.com/sns/latest/dg/sns-create-topic.html" target="_blank" rel="noopener noreferrer" class="">Amazon Simple Notification Service topic</a>.</li>
<li class="">Two EventBridge rules.<!-- -->
<ul>
<li class="">One rule to join Amazon EC2 instances to your AD domain.</li>
<li class="">One rule to unjoin Amazon EC2 instances from your AD domain.</li>
</ul>
</li>
<li class="">IAM roles and policies.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="walkthroughs">Walkthroughs<a href="#walkthroughs" class="hash-link" aria-label="Direct link to Walkthroughs" title="Direct link to Walkthroughs" translate="no">​</a></h2>
<p>I will start with the Amazon EC2 tag walkthrough. Tagging your Amazon EC2 instances with <strong>StartEvent</strong> will activate the EventBridge rule, triggering your Lambda function to execute the Automation runbook. The <a href="https://github.com/aws-samples/ssm-automation-custom-ad-domain-join-unjoin/blob/main/templates/lambda/ec2-tags-domainjoinunjoin.py" target="_blank" rel="noopener noreferrer" class="">Lambda function</a> evaluates the domain activity based on the Amazon EC2 tag value, either <strong>Join</strong> or <strong>Unjoin</strong>. In addition, the Lambda function will start Amazon EC2 instances if they are not in a running state before executing the Automation runbook.</p>
<p><strong>Note:</strong> Additional tag compliances can be configured in your AWS account with services such as <a href="https://docs.aws.amazon.com/config/latest/developerguide/WhatIsConfig.html" target="_blank" rel="noopener noreferrer" class="">AWS Config</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="amazon-ec2-tag-walkthrough">Amazon EC2 tag walkthrough<a href="#amazon-ec2-tag-walkthrough" class="hash-link" aria-label="Direct link to Amazon EC2 tag walkthrough" title="Direct link to Amazon EC2 tag walkthrough" translate="no">​</a></h3>
<p>New or existing Amazon EC2 tags are matched with the <strong>Tag Change on Resource</strong> event.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;detail-type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Tag Change on Resource&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;source&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;aws.tag&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;detail&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;changed-tag-keys&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;StartEvent&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;service&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;ec2&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;resource-type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;instance&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Now I will walk through <a href="https://aws.amazon.com/powershell/" target="_blank" rel="noopener noreferrer" class="">AWS Tools for PowerShell</a> examples to join multiple Amazon EC2 instances from an AD domain using EC2 tags.</p>
<ol>
<li class="">Open the console, search for <strong>AWS CloudShell</strong>, and select <strong>CloudShell</strong> (Figure 2).</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image2-5f16081e6278994751c94ce6fed3764c.png" width="1431" height="229" class="img_ev3q"></p>
<p>Figure 2 - Opening CloudShell from the AWS Management Console.</p>
<ol start="2">
<li class="">At the <strong>CloudShell</strong> prompt, type <strong>pwsh</strong>, and press <strong>Enter</strong>.</li>
<li class="">At the PowerShell prompt, paste and run the following PowerShell statement to launch Windows Amazon EC2 instances.<!-- -->
<ul>
<li class="">Replace <strong>SubnetId</strong>, <strong>SecurityGroupId</strong>, and <strong>IamInstanceProfile_Arn</strong> parameters with values within your AWS account.</li>
<li class="">This walkthrough launches 4 Amazon EC2 instances of m6i.2xlarge instance type.</li>
</ul>
</li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Import-Module AWS.Tools.EC2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$imageId = Get-SSMLatestEC2Image -Path ami-windows-latest -ImageName &quot;Windows_Server-2019-English-Core-Base&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$nameTag = @{Key=&quot;Name&quot;;Value=&quot;AD-PowerShell-Join-Demo&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$adJoinTag = @{Key=&quot;StartEvent&quot;;Value=&quot;Join&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$tagSpecAdJoin = New-Object -TypeName Amazon.EC2.Model.TagSpecification</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$tagSpecAdJoin.ResourceType = &quot;instance&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$tagSpecAdJoin.Tags.Add($nameTag)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$tagSpecAdJoin.Tags.Add($adJoinTag)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New-EC2Instance -ImageId $imageId -MaxCount 4 -InstanceType &quot;YOURINSTANCETYPE&quot; -SubnetId &quot;YOURSUBNETID&quot; -SecurityGroupId &quot;YOURSECURITYGROUPID&quot; -TagSpecification $tagSpecAdJoin -IamInstanceProfile_Arn &quot;YOURINSTANCEPROFILEARN&quot;</span><br></span></code></pre></div></div>
<ol start="4">
<li class="">If successful, a <strong>ReservationID</strong> will be displayed in CloudShell (Figure 3).</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image3-cd961110437674775fbcca7041742c6e.png" width="1431" height="565" class="img_ev3q"></p>
<p>Figure 3 - Running <strong>New-EC2Instance</strong> cmdlet in AWS CloudShell.</p>
<ol start="5">
<li class="">Confirm the EC2 instances are launching in the <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer" class="">Amazon EC2 console</a> (Figure 4).</li>
<li class="">In the navigation pane, choose <strong>Instances</strong>, and the running Amazon EC2 instances will be listed in the console.</li>
<li class="">After all status checks have passed, navigate to the <a href="https://console.aws.amazon.com/systems-manager/" target="_blank" rel="noopener noreferrer" class="">Systems Manager console</a>.</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image4-00bf404fe0a1a54c2727dc6581e4171f.png" width="1431" height="370" class="img_ev3q"></p>
<p>Figure 4 - Four new EC2 instances launched from AWS CloudShell.</p>
<ol start="8">
<li class="">In the navigation pane, select <strong>Automation</strong>. If successful, 4 executions will be listed (Figure 5).</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image5-1feac6b7e6b70d7423864da2d972ba98.png" width="1431" height="456" class="img_ev3q"></p>
<p>Figure 5 - Four Automation runbook executions with a status code of <strong>Success</strong> which means the AD domain join was completed.</p>
<p>Now I will show you how easy it is to remove these Amazon EC2 instances from the same AD domain using PowerShell.</p>
<ol start="9">
<li class="">Follow Step 1 to launch <strong>CloudShell</strong> if it was closed.</li>
<li class="">At the PowerShell prompt, paste and run the following PowerShell statement, making note of the Amazon EC2 tag&#x27;s value changing to <strong>Unjoin</strong>.</li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Import-Module AWS.Tools.EC2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$adUnjoinTag = New-Object -TypeName Amazon.EC2.Model.Tag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$adUnjoinTag.Key = &quot;StartEvent&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$adUnjoinTag.Value = &quot;Unjoin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$instanceIds = (Get-EC2Instance -Filter @{Name=&quot;tag:Name&quot;;Values=&quot;AD-PowerShell-Join-Demo&quot;}).Instances.InstanceId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach ($instanceid in $instanceIds) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    New-EC2Tag -Resource $instanceid -Tag $adUnjoinTag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol start="11">
<li class="">If successful, validate the tags are changed in the Amazon EC2 console (Figure 6).</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image6-bc6cebd9cd7204ae5483ee7342ce7d20.png" width="1429" height="662" class="img_ev3q"></p>
<p>Figure 6 - Tag value changed to <strong>Unjoin</strong> after running the PowerShell script.</p>
<ol start="12">
<li class="">Navigate to the <a href="https://console.aws.amazon.com/systems-manager/" target="_blank" rel="noopener noreferrer" class="">Systems Manager console</a>.</li>
<li class="">In the navigation pane, select <strong>Automation</strong>. A new set of executions will have started, attempting to remove the Amazon EC2 instances from the AD domain.</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="amazon-ec2-auto-scaling-walkthrough">Amazon EC2 Auto Scaling walkthrough<a href="#amazon-ec2-auto-scaling-walkthrough" class="hash-link" aria-label="Direct link to Amazon EC2 Auto Scaling walkthrough" title="Direct link to Amazon EC2 Auto Scaling walkthrough" translate="no">​</a></h3>
<p>New Amazon EC2 instances that are launched by an Auto Scaling group are matched with the <strong>EC2 Instance-launch Lifecycle Action</strong> event.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;detail-type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;EC2 Instance-launch Lifecycle Action&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;source&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;aws.autoscaling&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;detail&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;AutoScalingGroupName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;YOURASGNAME&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Terminating Amazon EC2 instances from an Auto Scaling group is matched with the <strong>EC2 Instance-terminate Lifecycle Action</strong> event. The event pattern differs slightly with the <strong>detail-type</strong> of the EC2 Instance-terminate Lifecycle Action.</p>
<p>Another scalable method to perform AD domain join or unjoin is with Amazon EC2 Auto Scaling. Windows workloads that are AD-aware scale with an Auto Scaling group and ensure that each Amazon EC2 instance are added to an AD domain at launch or removed from the same AD domain before termination. EventBridge rules monitor Auto Scale group events through their lifecycle policies.</p>
<p>Now I will walk through an example of scaling up and down with an AD domain.</p>
<ol start="14">
<li class="">Navigate to the <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer" class="">Amazon EC2 console</a>.</li>
<li class="">In the navigation pane, choose <strong>Auto Scaling Groups</strong>, and then select the Auto Scaling group created by the CloudFormation template (Figure 7).</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image7-17518dd6d201f964eff44585846c01b4.png" width="1431" height="342" class="img_ev3q"></p>
<p>Figure 7 - Auto Scaling group created by the CloudFormation template.</p>
<ol start="16">
<li class="">In <strong>Details</strong> tab, select <strong>Edit</strong> in the <strong>Group Details</strong> panel (Figure 8).</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image8-bc87cb7837d7ee8e772201bc9eb88eee.png" width="1428" height="515" class="img_ev3q"></p>
<p>Figure 8 - The Details tab showing the Auto Scaling group details.</p>
<ol start="17">
<li class="">Change the <strong>Desired capacity type</strong> from <strong>0</strong> to <strong>1</strong> and select <strong>Update</strong>. This will add one new Amazon EC2 instance to the Auto Scaling group (Figure 9).</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image9-6f2eadca6a9e00447796eb69214b57cb.png" width="1202" height="1094" class="img_ev3q"></p>
<p>Figure 9 - Manually changing the <strong>Desired Capacity</strong> from 0 to 1, manually adding a new Amazon EC2 instance to the Auto Scaling group.</p>
<ol start="18">
<li class="">In the <strong>Instance management</strong> tab, the Lifecycle of the Amazon EC2 instance will change from <strong>Pending<!-- -->:Wait</strong> to <strong>InService</strong> (Figure 10).</li>
</ol>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image10-5397a00ca4f52d4fd0e4c10949462fa9.png" width="1430" height="794" class="img_ev3q"></p>
<p>Figure 10 - New Amazon EC2 instance in <strong>Pending<!-- -->:Wait</strong> lifecycle, which will trigger the EventBridge rule to call Systems Manager Automation.</p>
<ol start="19">
<li class="">Navigate to the <a href="https://console.aws.amazon.com/systems-manager/" target="_blank" rel="noopener noreferrer" class="">Systems Manager console</a>.</li>
<li class="">In the navigation pane, select <strong>Automation</strong>.</li>
</ol>
<p>Just like the Amazon EC2 tag example, Systems Manager will execute the AD domain Automation runbook to show that the Auto Scaling launched Amazon EC2 instance has joined the AD domain (Figure 11).</p>
<p><strong>Note:</strong> If the AD domain join fails, Amazon EC2 instances are stopped and tagged appropriately. If the failure is not remediated, continual scaling activities will occur within an Auto Scaling group. Test your AD join and unjoin with a smaller set of Amazon EC2 instances.</p>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image11-ff0265d926784625166184e89e3fb78a.png" width="1431" height="337" class="img_ev3q"></p>
<p>Figure 11 - The Automation runbook execution with a status code of <strong>Success</strong> which means the AD domain join was completed.</p>
<p>Repeating steps 14 -- 18 and changing <strong>Desired capacity type</strong> to <strong>0</strong> will start the removal of Amazon EC2 instances launched by the Auto Scaling group. The event pattern will see the termination lifecycle hook and attempt to remove the Amazon EC2 instance from your AD domain. To confirm, go to the <strong>Instance management</strong> tab and confirm that the Lifecycle changes from <strong>InService</strong> to <strong>Terminating<!-- -->:Wait</strong> <strong>(Figure 12)</strong>.</p>
<p><img decoding="async" loading="lazy" src="/technical-notes-for-microsoft-workloads-on-aws/assets/images/image12-91664a3312bb18d5a0231e78f22a068d.png" width="1430" height="794" class="img_ev3q"></p>
<p>Figure 12 - Example of an Amazon EC2 instance in a <strong>Terminating<!-- -->:Wait</strong> lifecycle. EventBridge will initiate the Systems Manager Automation runbook to perform an AD domain unjoin activity.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/aws-samples/technical-notes-for-microsoft-workloads-on-aws/blob/main/docusaurus/docs/Active Directory/Guides/Event-driven_Active_Directory_domain_join_with_Amazon_EventBridge/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/technical-notes-for-microsoft-workloads-on-aws/Active Directory/Guides/Active_Directory_domain_join_with_AWS_Systems_Manager_and_AWS_Secrets_Manager/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Active Directory domain join with AWS Systems Manager and AWS Secrets Manager</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/technical-notes-for-microsoft-workloads-on-aws/Windows Containers/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Windows Containers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#solution-overview" class="table-of-contents__link toc-highlight">Solution Overview</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#walkthroughs" class="table-of-contents__link toc-highlight">Walkthroughs</a><ul><li><a href="#amazon-ec2-tag-walkthrough" class="table-of-contents__link toc-highlight">Amazon EC2 tag walkthrough</a></li><li><a href="#amazon-ec2-auto-scaling-walkthrough" class="table-of-contents__link toc-highlight">Amazon EC2 Auto Scaling walkthrough</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> © 2026.  Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>